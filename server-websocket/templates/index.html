<html>
    <head>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
        <meta name="viewport" content="width=device-width, user-scalable=no">
	    <script src="{{ url_for('static', filename='js/jquery-3.3.1.min.js')}}"></script>
        <script src="{{ url_for('static', filename='js/socket.io.js') }}"></script>
        <script src="{{ url_for('static', filename='js/joy.min.js') }}"></script>
    </head>
    <body>
	<div id="infozone" class="info_zone">
	    <div id="connex" style="text-align:center;width:100%;margin:0;padding:0;">
                <div class="led-box"><div class="led-red"></div><div class="led-text">Not Connected</div></div>
            </div>
	    <img src="" id="cam" width="100%" />
        </div>

	<div id="filler" style="height: 60%"></div>

	<div id="controls" class="controls">
            <div id="joystick" class="joystick_zone" style="float:left;">
	    </div>
	    <div id="placeholder" style="width: 100%"></div>
            <div id="joystick2" class="joystick_zone" style="float:right;">
                <a href="#" id="button1" onclick="socket_control.emit('control', { data: { "A" : 1 } });" class="button buttonB noSelect" style="float:right;"></a>
	    </div>
	</div>

        <script type="text/javascript">
	    document.getElementById("cam").src = 'http://' + location.hostname + ':8080/';
            var socket_status = io.connect('http://'+location.host+"/status");
            var socket_control = io.connect('http://'+location.host+"/control");

            $(document).ready(function(){
		document.documentElement.webkitRequestFullScreen();
                /* connected display */
                setInterval(function(){
                    if(socket_control.connected){
                        $('#connex').html('<div class="led-box"><div class="led-blue"></div><div class="led-text">Connected</div></div>');
                    }else{
                        $('#connex').html('<div class="led-box"><div class="led-red"></div><div class="led-text">Not Connected</div></div>');
                    }
                }, 1000);

                /******************************************
                  JOYSTICKS
                  *****************************************/
                var Joy1 = new JoyStick('joystick', { "height": 200, "width": 200 }, function(stickData) {
                    // console.log("joy1 used" + JSON.stringify({ data:{"left": [ stickData.x, stickData.y ] } }))
                    socket_control.emit('control', { data: { "left" : [ stickData.x, stickData.y ] } });
                });
                var Joy2 = new JoyStick('joystick2', {}, function(stickData) {
                    // console.log("joy2 used" + JSON.stringify({ data:{"left": [ stickData.x, stickData.y ] } }))
                    socket_control.emit('control', { data: { "right" : [ stickData.x, stickData.y ] } });
                });
            });
            
        </script>
    </body>
</html>
